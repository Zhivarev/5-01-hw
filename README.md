# Домашнее задание к занятию "`Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения`" - `Живарев Игорь`


### Задание 1
`Опишите кратко, в чём основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.`

1. Полная виртуализация - способ виртуализации предполагает использование программного обеспечения, получившего название «гипервизор», суть которого заключается в создании уровня абстракции между виртуальными серверами и базовым аппаратным обеспечением. Примерами коммерческих решений, в которых реализован данный подход, могут служить программные продукты VMware и Microsoft Virtual PC, а KVM (Kernel Virtual Machine) — это свободно распространяемое решение для ОС Linux.

Гипервизор перехватывает команды центрального процессора и служит посредником для доступа к аппаратным контроллерам и периферии. В результате полная виртуализация позволяет установить на виртуальный сервер практически любую операционную систему без каких-либо изменений, причем сама ОС ничего не будет знать о том, что она работает в виртуализованной среде. Основной недостаток данного подхода связан с накладными расходами, которые несет процессор в связи с работой гипервизора. Эти накладные расходы невелики, но ощутимы.

В полностью виртуализованной среде гипервизор взаимодействует непосредственно с аппаратным обеспечением и серверами в качестве хостовой операционной системы. Операционные системы, работающие на виртуальных серверах, которыми управляет гипервизор, называют гостевыми.

2. Паравиртуализация - предполагает серьезное использование ресурсов процессора, обусловленное наличием гипервизора, управляющего различными виртуальными серверами и обеспечивающего независимость этих серверов друг от друга. Уменьшить эту нагрузку можно, например, модифицировав каждую операционную систему таким образом, чтобы она «знала» о том, что она работает в виртуализованной среде, и могла взаимодействовать с гипервизором. Такой подход называют паравиртуализацией.

Примером свободно распространяемой реализации технологии паравиртуализации может служить Xen. Прежде чем операционная система сможет работать в качестве виртуального сервера в гипервизоре Xen, в нее необходимо внести определенные изменения на уровне ядра. Благодаря этому Xen прекрасно работает с BSD, Linux, Solaris и другими свободно распространяемыми операционными системами, но не подходит для виртуализации таких операционных систем, как Windows, которые менять нельзя.

Преимуществом паравиртуализации является более высокая производительность. Паравиртуализованные серверы, работающие вместе с гипервизором, обеспечивают почти такую же скорость, как невиртуализованные серверы.

3. Виртуализация на уровне ос — встроенная поддержка виртуальных серверов на уровне операционной системы. Этот подход использован в Solaris Containers, Virtuozzo/OpenVZ делает нечто похожее для ОС Linux, а во FreeBSD подход реализован FreeBSD Jail.

При виртуализации на уровне операционной системы не существует отдельного слоя гипервизора. Вместо этого сама хостовая операционная система отвечает за разделение аппаратных ресурсов между несколькими виртуальными серверами и поддержку их независимости друг от друга. Отличие этого подхода от других проявляется, прежде всего, в том, что в этом случае все виртуальные серверы должны работать в одной и той же операционной системе (хотя каждый экземпляр имеет свои собственные приложения и регистрационные записи пользователей).

То, что виртуализация на уровне операционной системы теряет в гибкости, она восполняет за счет производительности, которая близка к производительности невиртуализованных серверов. Кроме того, архитектурой, которая использует одну стандартную ОС для всех виртуальных серверов, намного проще управлять, чем в более гетерогенной средой.


### Задание 2
Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

Организация серверов:

физические сервера,
паравиртуализация,
виртуализация уровня ОС.
Условия использования:

Высоконагруженная база данных, чувствительная к отказу.
Различные web-приложения.
Windows системы для использования бухгалтерским отделом.
Системы, выполняющие высокопроизводительные расчеты на GPU.
Опишите, почему вы выбрали к каждому целевому использованию такую организацию.


1. Для высоконагруженных баз лучшим решением будет аппаратная виртуализация типа ESXI или XEN поскольку при этом максимум ресурсов можно выделить для ВМ и при этом обеспечить отказоустойчивость и резевное копирование.

2. Для различных web-приложений лучше всего подойдет контейнеризация типа Docker или LXC, поскольку их гораздо легче масштабировать в заисимости от нагрузки сервисов.

3. Windows системы для использования бухгалтерским отделом - паравиртуализация, так как можно гибко распределять ресурсы между ВМ, либо разворачивать ВМ из шаблона. Изолированность гостевых ОС друг от друга.

4. Системы, выполняющие высокопроизводительные расчеты на GPU - физические сервера, так как требуется прямой доступ к графическому оборудованию.


### Задание 3
Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based-инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
Требуется наиболее производительное бесплатное open source-решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows-инфраструктуры.
Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.


1. ESXI или Vsphere, в заисимости от бюджета. Машин довольно много и управлять их резервным копированием, миграцией и ресурсами будет удобно. Более того к гостевым системам нет вообще никаких ограничений.

2. В качестве бесплатных opensource решений подойдут Proxmox+KVM, либо Xen.

3. Бесплатным и максимально совместимым решением для Windows инфраструктуры будет выступать Microsoft Hyper-V Server. Ограничений в нем никаких нет (в отличие от бесплатной версии VMware), вы можете включить его в домен, управлять ею с помощью Windows Admin Center, бэкапить.

4. Для тестирования программного продукта на нескольких дистрибутивах Linux можно использовать связку Vagrant и Virtual Box. Позволяет быстро развернуть ВМ с необходимыми настройками.


### Задание 4
Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.


Гетерогенные виртуальные среды также могут быть неэффективны и сложны в управлении. Многие компании решили реализовывать пошаговую стратегию виртуализации ИТ-инфраструктуры, постепенно внедряя решения от различных производителей. Такой подход подразумевает, что определенные типы устройств выполняют соответственные задачи, и при этом компания зависит от продукции не одного вендора. Учитывая тот факт, что для управления таким «лоскутным одеялом» требуется целый набор специалистов различного профиля, данный способ виртуализации инфраструктуры является дорогостоящим и неэффективным в долгосрочной перспективе, поскольку, по мере развития технологий, компании стремятся обеспечить легкость в управлении, совместимость различных систем и масштабируемость инфраструктуры.

Разнородность директорий хранения данных и произвольное расположение виртуальных машин в инфраструктуре значительно усложняет задачу управления огромными объемами динамических данных. Эта проблема особенно ощутима, когда ИТ-отделу компании необходимо обеспечить оперативную миграцию данных и виртуальных машин между виртуальными и физическими средами в рамках физической ИТ-инфраструктуры предприятия, в ЦОДах или «облаке».

Для того, чтобы ощутить все преимущества виртуализации, компаниям недостаточно просто виртуализовать серверы и приложения. ИТ-специалисты должны пересмотреть свой подход к осуществлению процесса виртуализации: существует риск, что ИТ-инфраструктурой будет сложно управлять, при этом также могут возникнуть проблемы совместимости различных технологий. При неверном подходе виртуализация создаст дополнительные проблемы и еще больше снизит эффективность ИТ-инфраструктуры. Ниже приведены три ключевых принципа, которые помогут понять и реализовать все преимущества виртуализации:

- Для гибридной среды нужны гибридные решения – необходимо использовать комплексные решения, которые смогут функционировать как в физической, так и в виртуальной среде
- Меньше – значит больше – нужно максимально снизить вероятность несовместимости технологий и упростить управление инфраструктурой для обеспечения совместимости и масштабируемости ИТ-инфраструктуры в рамках всей виртуальной среды
- Необходимость в универсальной платформе для удобного перемещения и защиты данных – универсальная платформа упростит перемещение данных между гипервизорами и обеспечит их надежную защиту, автоматически создавая виртуальные машины в качестве резервной копии физических серверов, чтобы не перемещать виртуальные машины полностью.
